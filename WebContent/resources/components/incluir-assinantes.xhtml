<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<composite:interface>
	<composite:attribute name="bean" />
</composite:interface>

<composite:implementation>
	<script>  
		function moeda(z){  
			v = z.value;
			v = v.replace(/\D/g,"")  //permite digitar apenas números
			v = v.replace(/[0-9]{12}/,"inválido")   //limita pra máximo 999.999.999,99
			v = v.replace(/(\d{1})(\d{8})$/,"$1.$2")  //coloca ponto antes dos últimos 8 digitos
			v = v.replace(/(\d{1})(\d{5})$/,"$1.$2")  //coloca ponto antes dos últimos 5 digitos
			v = v.replace(/(\d{1})(\d{1,2})$/,"$1,$2")        //coloca virgula antes dos últimos 2 digitos
			z.value = 'R$ ' + v;
		}
	</script>
	<p:panel id="pnlAssinantes" styleClass="pnlAssinantes">
		<h:messages />
		<h:panelGrid columns="6" styleClass="pnlgInformacao"
			columnClasses="pnlgInformacao_c1, pnlgInformacao_c2, pnlgInformacao_c3, pnlgInformacao_c4, pnlgInformacao_c5, pnlgInformacao_c6">
			<p:outputLabel value="Cód. Assinante" for="intCodAssinante" />
			<p:inputText id="intCodAssinante" styleClass="iptCodAss"
				value="#{cc.attrs.bean.selected.id}" disabled="true" />
			<p:outputLabel value="Data Inclusão" for="intDtInclusao"
				styleClass="oplDtInclusao" />
			<p:calendar id="intDtInclusao" styleClass="iptDtInclusao"
				value="#{cc.attrs.bean.selected.dataInclusaoTela}" disabled="true"
				pattern="dd/MM/yyyy" />
			<p:outputLabel value="Tipo Inclusão" for="intTipoInclusao"
				styleClass="oplTpInclusao" />
			<p:inputText id="intTipoInclusao" styleClass="iptTpInclusao"
				value="#{cc.attrs.bean.selected.tipoInclusao}" disabled="true" />
		</h:panelGrid>
		<p:tabView styleClass="tabDados">
			<p:tab title="Dados Assinantes">
				<p:fieldset id="fdsDadosAssinantes" styleClass="dadosAssinantes">
					<h:panelGrid columns="2">
						<p:outputLabel value="Razão Social" for="intRazaoSocial" />
						<p:inputText id="intRazaoSocial" styleClass="iptDadosAssinantes"
							value="#{cc.attrs.bean.selected.razaoSocial}" />
						<p:outputLabel value="Endereço" for="intEndereco" />
						<h:panelGrid columns="3" styleClass="pnlgEndereco"
							columnClasses="pnlgEndereco_c1,pnlgEndereco_c2,pnlgEndereco_c3">
							<p:inputText id="intEndereco"
								value="#{cc.attrs.bean.selected.endereco}"
								styleClass="iptEndereco" />
							<p:outputLabel value="Nº " for="intNumero" styleClass="oplNumero" />
							<p:inputMask id="intNumero"
								value="#{cc.attrs.bean.selected.enderecoNumero}"
								styleClass="iptNumero" mask="9?9999" />
						</h:panelGrid>
						<p:outputLabel value="Complemento" for="intComplemento" />
						<p:inputText id="intComplemento" styleClass="iptDadosAssinantes"
							value="#{cc.attrs.bean.selected.enderecoComplemento}" />
						<p:outputLabel value="Bairro" for="intBairro" />
						<h:panelGrid columns="3">
							<p:inputText id="intBairro" styleClass="iptBairro"
								value="#{cc.attrs.bean.selected.bairro}" />
							<p:outputLabel value="CEP" for="intCep" />
							<p:inputMask id="intCep" value="#{cc.attrs.bean.selected.cep}"
								mask="99999-999" styleClass="iptCep" />
						</h:panelGrid>
						<p:outputLabel value="Município" for="intMunicipio" />
						<h:panelGrid columns="3">
							<p:inputText id="intMunicipio"
								value="#{cc.attrs.bean.selected.municipio}" />
							<p:outputLabel value="UF" for="somUf" />
							<p:selectOneMenu id="somUf" value="#{cc.attrs.bean.selected.uf}"
								styleClass="selectUf">
								<f:selectItem itemLabel="" itemValue="#{null}"
									noSelectionOption="true" />
								<f:selectItems value="#{cc.attrs.bean.selected.estados}" />
								<p:ajax event="change"
									listener="#{consultaAssinantesAdmMB.mascaraInscrEstadual}"
									update="intInscEst" />
							</p:selectOneMenu>
						</h:panelGrid>
						<p:outputLabel value="CNPJ" for="intCnpj" />
						<h:panelGrid columns="3">
							<p:inputMask id="intCnpj" value="#{cc.attrs.bean.selected.cnpj}"
								mask="99.999.999/9999-99" />
							<p:outputLabel value="Inscr.Estadual" for="intInscEst" />
							<p:inputMask id="intInscEst"
								value="#{cc.attrs.bean.selected.inscricaoEstadual}"
								mask="#{consultaAssinantesAdmMB.mascara}" />
						</h:panelGrid>
					</h:panelGrid>
				</p:fieldset>
				<h:panelGrid columns="1">
					<p:fieldset id="fdsUsuarios" legend="Usuários"
						styleClass="dadosUsuarios">
						<p:messages id="msgs" />
						<h:panelGrid columns="6" styleClass="gridUsuarioAss"
							columnClasses="gUA_c1,gUA_c2,gUA_c3,gUA_c4,gUA_c5,gUA_c6">
							<p:outputLabel value="Usuário" for="intUsuario" />
							<p:inputText id="intUsuario" value="#{bean.login}">
								<p:ajax event="blur" update="intUsuario" />
							</p:inputText>
							<p:outputLabel value="Senha" for="pwdUsuario" />
							<p:password id="pwdUsuario" value="#{bean.senha}">
								<p:ajax event="blur" />
							</p:password>
							<p:commandButton id="cbIncluir" value=""
								style="background-image: url('resources/images/incluir.gif') !important;">
								<p:ajax event="click" listener="#{bean.adicionaUsuario}"
									process="@this" update="dtbUsuarios,msgs" />
							</p:commandButton>
							<p:commandButton id="cmbExcluir" value=""
								style="background-image: url('resources/images/minus.png') !important;">
								<p:ajax event="click" listener="#{bean.removeUsuario}"
									process="@this" update="dtbUsuarios" />
							</p:commandButton>
							<p:tooltip for="cmbExcluir" value="Excluir" />
							<p:tooltip for="cbIncluir" value="Incluir" />
						</h:panelGrid>
						<p:dataTable id="dtbUsuarios" styleClass="dataTableUsuariosAss"
							scrollable="true" scrollHeight="100"
							value="#{cc.attrs.bean.selected.usuarios}" var="usuario"
							emptyMessage="Nenhum registro encontrado.">
							<p:column headerText="ID">
								<h:outputText value="#{usuario.id}" />
							</p:column>
							<p:column headerText="Usuário">
								<h:outputText value="#{usuario.login}" />
							</p:column>
						</p:dataTable>
					</p:fieldset>
				</h:panelGrid>
			</p:tab>
			<p:tab title="Plano Contratação">
				<h:panelGrid columns="2">
					<p:outputLabel value="Cód.Plano" for="somCodPlano" />
					<p:selectOneMenu id="somCodPlano" value="#{bean.plano}"
						styleClass="codPlanoAss">
						<f:selectItem itemLabel="" itemValue="#{null}"
							noSelectionOption="true" />
						<f:selectItems value="#{bean.planos}" />
						<p:ajax event="change" update="intDescrPlano,intValorMensal" />
					</p:selectOneMenu>
					<p:outputLabel value="Descr.Plano" for="intDescrPlano" />
					<p:inputText id="intDescrPlano"
						value="#{cc.attrs.bean.selected.plano.descricao}" disabled="true"
						styleClass="descPlanoAss" />
					<p:outputLabel value="Valor Mensal" for="intValorMensal" />
					<p:inputText id="intValorMensal" onkeypress="moeda(this);"
						maxlength="14" value="#{cc.attrs.bean.selected.plano.valorMensal}"
						styleClass="vlMensalAss" mask="R$ 9?999,99" disabled="true">
						<f:convertNumber type="currency" />
					</p:inputText>
				</h:panelGrid>
			</p:tab>
			<p:tab title="Contabilidade">
				<h:panelGrid columns="2">
					<p:outputLabel value="Cód.Cont." for="somCodCont" />
					<p:selectOneMenu id="somCodCont" value="#{bean.contabilidade}"
						styleClass="codContAss">
						<f:selectItem itemLabel="" itemValue="#{null}"
							noSelectionOption="true" />
						<f:selectItems value="#{bean.contabilidades}" />
					</p:selectOneMenu>
					<p:outputLabel value="CNPJ" for="intContCnpj" />
					<p:inputMask id="intContCnpj" disabled="true"
						value="#{cc.attrs.bean.selected.contabilidade.cnpj}"
						mask="99.999.999/9999-99" styleClass="cnpjAss" />
					<p:outputLabel value="Razão Social" for="intContRazaoSocial" />
					<p:inputText id="intContRazaoSocial" disabled="true"
						value="#{cc.attrs.bean.selected.contabilidade.razaoSocial}"
						styleClass="razaoSocialAss" />
				</h:panelGrid>
			</p:tab>
			<p:tab title="Parametros">
				<h:panelGrid columns="3" styleClass="pngParametros"
					columnClasses="pngParametros_c1,pngParametros_c2,pngParametros_c3">
					<h:column>
						<p:outputLabel value="Certificado Digital A1" for="uplCertDigital" />
					</h:column>
					<h:column>
						<p:fileUpload id="uplCertDigital"
							value="#{consultaAssinantesAdmMB.file}" mode="simple"
							rendered="#{bean.showUpload}" />
						<p:tooltip for="uplCertDigital"
							value="Escolha aqui o Arquivo Referente ao Certificado Digital A1" />
						<p:outputLabel
							value="#{cc.attrs.bean.selected.certificadoA1.nome}"
							rendered="#{bean.showUploadNome}" styleClass="uploadNome" />
					</h:column>
						<p:spacer />
						<p:spacer />
					<h:panelGrid columns="2" styleClass="pngParametrosNotificar"
						columnClasses="pngParametrosNotificar_c1,pngParametrosNotificar_c2">
						<p:selectBooleanCheckbox id="ckbNotificar"
							value="#{cc.attrs.bean.selected.certificadoA1.notificarExpiracaoCertificado}"
							styleClass="chkNotificar" />
						<p:outputLabel
							value="Notificar por e-mail quando o Certificado estiver próximo de expirar?"
							styleClass="oplNotificar" for="ckbNotificar" />
					</h:panelGrid>
					<p:spacer />
					<p:outputLabel value="E-mail Master" for="intEmailMaster" />
					<p:inputText id="intEmailMaster"
						value="#{cc.attrs.bean.selected.emailMaster}"
						styleClass="iptEmailMaster" />
					<p:tooltip for="intEmailMaster"
						value="Digite aqui o endereço de e-mail do responsável pelo Serviço no Assinante" />
					<p:spacer />
					<p:outputLabel
						value="Todas as atualizações, revisões, melhorias e notificações técnicas serão enviadas para este e-mail."
						styleClass="oplAviso" />
					<p:spacer />
					<p:outputLabel value="E-mail Financeiro" for="intEmailFinanceiro" />
					<p:inputText id="intEmailFinanceiro"
						value="#{cc.attrs.bean.selected.emailFinanceiro}"
						styleClass="iptEmailFinanceiro" />
					<p:tooltip for="intEmailFinanceiro"
						value="Digite aqui o endereço de e-mail do Assinante responsável pelo Financeiro/Contas a Pagar" />
					<p:spacer />
					<p:outputLabel
						value="Este endereço de e-mail receberá os Boletos e Notas Fiscais Referente a Assinatura Mensal"
						styleClass="oplAviso2" />
				</h:panelGrid>
			</p:tab>
		</p:tabView>
		<br />
		<div id="botaoIncluirAlterarAss">
			<p:commandButton id="cdbIncluir" rendered="#{bean.botaoIncluir}"
				style="background-image: url('resources/images/check.png') !important;"
				value=" Incluir" styleClass="botaoIncluirAlterarAss"
				oncomplete="PF('dlgIncluirAssinante').show();">
				<p:ajax event="click" listener="#{bean.incluir()}" process="@this" />
			</p:commandButton>
			<p:commandButton id="cdbAlterar" rendered="#{bean.botaoAlterar}"
				style="background-image: url('resources/images/check.png') !important;"
				styleClass="botaoIncluirAlterarAss" value=" Alterar">
				<p:ajax event="click" listener="#{bean.alterar()}" process="@this" />
			</p:commandButton>
		</div>
	</p:panel>
	<p:dialog widgetVar="dlgIncluirAssinante" id="dlgIncluirAssinante">
		<p:outputLabel value="Assinante inserido com sucesso" />
	</p:dialog>
</composite:implementation>
</html>