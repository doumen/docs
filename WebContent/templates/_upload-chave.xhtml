<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:golive="http://java.sun.com/jsf/composite/components"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/templates/_panel-titulo.xhtml">

	<ui:define name="conteudoPainel">
		<p:tabView>
			<p:tab title="Arquivos">
			
				<golive:upload bean="#{bean}"></golive:upload>
		
			</p:tab>
			<p:tab title="Chaves da #{docto}">
			<p:growl id="growl2" showDetail="true" sticky="true" widgetVar="growl"/>
				<h:panelGrid columns="2" cellpadding="10" columnClasses="upload_chave_h1,upload_chave_h2" style="width:100%">
					<h:column>
						<p:inputText value="#{bean.chave}" id="chv" styleClass="chv"></p:inputText>
						<p:commandButton value="Incluir Chave #{docto}" actionListener="#{bean.incluirChave}" update="dataTable,chv,growl2" style="margin:10px;"></p:commandButton>
						<p:commandButton value="Excluir Chave #{docto}" actionListener="#{bean.excluirChave}" update="dataTable" style="margin:10px;"></p:commandButton>
					</h:column>
					<h:column>
						<p:commandButton value="Processar #{docto}" actionListener="#{bean.processarNFe}" update="dataTable"></p:commandButton>
					</h:column>
				</h:panelGrid>
				<p:dataTable value="#{bean.chavesDoctos}" var="list" 
					 id="dataTable" selection="#{bean.selectedChave}" rowKey="#{list.chave}"
					emptyMessage="Nenhum registro encontrado." styleClass="dataTable">
					<p:column selectionMode="single" style="width:16px;text-align:center"/>
					<p:column headerText="Status" sortBy="#{list.ajaxStatus}"
						styleClass="upload_chave_col_status" filterBy="#{list.ajaxStatus}">
						<h:outputText value="#{list.ajaxStatus}">
						</h:outputText>
					</p:column>
					<p:column headerText="Chave #{docto}" sortBy="#{list.chave}"
						styleClass="upload_chave_col_chave" filterBy="#{list.chave}">
						<h:outputText value="#{list.chave}">
						</h:outputText>
					</p:column>
					<p:column headerText="Progresso" sortBy="#{list.progresso}"
						styleClass="upload_chave_col_progresso" filterBy="#{list.progresso}">
						<p:ajaxStatus style="text-align:center">
						    <f:facet name="default">
								<h:outputText value="#{list.progresso}">
									<f:convertNumber type="percent" />
								</h:outputText>
						    </f:facet>		 
						    <f:facet name="start">
		        				<p:graphicImage name="/demo/images/ajaxloadingbar.gif" />
						    </f:facet>		 
						    <f:facet name="complete">
								<h:outputText value="#{list.progresso}">
									<f:convertNumber type="percent" />
								</h:outputText>
						    </f:facet>
					</p:ajaxStatus>
						
						
					</p:column>
					<p:column headerText="Mensagem" sortBy="#{list.mensagem}"
						styleClass="upload_chave_col_mensagem" filterBy="#{list.mensagem}">
						<h:outputText value="#{list.mensagem}">
						</h:outputText>
					</p:column>

				</p:dataTable>
				
			</p:tab>
		</p:tabView>
	</ui:define>
</ui:composition>
</html>